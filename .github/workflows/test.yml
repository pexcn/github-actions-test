name: Build

on:
  push:

jobs:
  build:
    runs-on: ubuntu-20.04
    container:
      image: pexcn/docker-images:buster-openwrt
      options: --privileged --memory-swap 0
    env:
      TZ: Asia/Taipei

    steps:
      - name: Maximize build disk space
        uses: pexcn/maximize-build-space@master
        with:
          root-reserve-mb: 256
          swap-size-mb: 1024
          remove-dotnet: 'true'
          remove-android: 'true'
          remove-haskell: 'true'
          overprovision-lvm: 'true'

      - name: Checkout
        uses: actions/checkout@v2

      - name: Run build
        run: |
          df -h
          free -h
